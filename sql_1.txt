SELECT * FROM (SELECT OD.ORDERID, ORDERDATE , (SELECT CUSTOMERNAME FROM CUSTOMERS CS WHERE CS.CUSTOMERID = OD. CUSTOMERID) AS CUSTMERNAMERNAME ,
(SELECT PRODUCTNAME FROM PRODUCTS PS WHERE PS.PRODUCTID = ODD.PRODUCTID) AS PRODUCTNAME ,ODD.QUANTITY
FROM ORDERS OD
LEFT JOIN ORDERDETAILS ODD
ON OD.ORDERID = ODD.ORDERID
WHERE SUBSTR(ORDERDATE,0,5)= '1997' AND SUBSTR(ORDERDATE,6,2) = '01' ) T
ORDER BY CUSTMERNAMERNAME, 	OrderDate DESC;
